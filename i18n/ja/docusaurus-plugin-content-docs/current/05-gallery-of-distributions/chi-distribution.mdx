---
title: カイ分布(Chi distribution)
---

import DataGridMdx from "@site/src/components/DataGridMdx";

# カイ分布(Chi distribution)

## 分布の形状

### 基本情報

- 1つのパラメータ $N$ が必要です（正の整数）。
- 半無限区間 $x \geq 0$ で定義された連続分布です。
- [平均](/docs/glossary#central-moment)対して常に非対称です。

### 確率

- [確率密度関数](/docs/glossary#probability-density-function)

  $$
  f(x)=\frac{1}{2^{\frac{N}{2}-1}\Gamma\left(\frac{N}{2}\right)}\exp\left(-\frac{x^2}{2}\right)x^{N-1}
  $$

  , ここで $\Gamma(\cdot)$ は [ガンマ関数](/docs/glossary#gamma-function)です。

- [累積分布関数](/docs/glossary#cumulative-distribution-function)

  $$
  F(x)=\frac{\Gamma_{\frac{x^2}{2}}\left(\frac{N}{2}\right)}{\Gamma\left(\frac{N}{2}\right)}
  $$

  ここで $\Gamma_{x}(\cdot)$ は [不完全ガンマ関数](/docs/glossary#incomplete-gamma-function)です。

- Excel での[累積分布関数 (c.d.f.)](/docs/glossary#cumulative-distribution-function) と [確率密度関数 (p.d.f.)](/docs/glossary#probability-density-function)の求め方

<DataGridMdx
  data={{
    cells: [
      [
        { value: "データ", readOnly: true, className: "orange-cell" },
        { value: "説明", readOnly: true, className: "orange-cell" },
      ],
      [
        { value: "5", readOnly: true },
        { value: "対象となる値", readOnly: true },
      ],
      [
        { value: "9", readOnly: true },
        { value: "分布のパラメータ N の値", readOnly: true },
      ],
      [
        { value: "数式", readOnly: true, className: "orange-cell" },
        { value: "説明（計算結果）", readOnly: true, className: "orange-cell" },
      ],
      [
        { value: "=NTCHIDIST(A2,A3,TRUE)", readOnly: true },
        { value: "上のデータに対する累積分布関数の値", readOnly: true },
      ],
      [
        { value: "=NTCHIDIST(A2,A3,FALSE)", readOnly: true },
        { value: "上のデータに対する確率密度関数の値", readOnly: true },
      ],
    ],
  }}
/>

- 関連 NtRand 関数 : [NTCHIDIST](../03-function-reference/02-distribution-functions/010-ntchidist.mdx)

## 分布の特徴

### 平均 -- 分布の"中心"はどこ？ ([定義](/docs/glossary#central-moment))

- 分布の[平均](/docs/glossary#central-moment) は次式で与えられます。

  $$
  \sqrt{2}\frac{\Gamma\left(\frac{N+1}{2}\right)}{\Gamma\left(\frac{N}{2}\right)}
  $$

  ここで $\Gamma(\cdot)$ は [ガンマ関数](/docs/glossary#gamma-function)です。

- Excel での計算法

<DataGridMdx
  data={{
    cells: [
      [
        { value: "データ", readOnly: true, className: "orange-cell" },
        { value: "説明", readOnly: true, className: "orange-cell" },
      ],
      [
        { value: "8", readOnly: true },
        { value: "分布のパラメータ N の値", readOnly: true },
      ],
      [
        { value: "数式", readOnly: true, className: "orange-cell" },
        { value: "説明（計算結果）", readOnly: true, className: "orange-cell" },
      ],
      [
        { value: "=NTCHIMEAN(A2)", readOnly: true },
        { value: "上のデータに対する分布の平均", readOnly: true },
      ],
    ],
  }}
/>

- 関連 NtRand 関数 : [NTCHIMEAN](../03-function-reference/02-distribution-functions/013-ntchimean.mdx)

### 標準偏差 -- 分布はどのくらい広がっているか（[定義](/docs/glossary#standard-deviation)）

- 分布の[分散](/docs/glossary#variance) は次式で与えられます。

  $$
  N-2\left[\frac{\Gamma\left(\frac{N+1}{2}\right)}{\Gamma\left(\frac{N}{2}\right)}\right]^2
  $$

  [標準偏差](/docs/glossary#standard-deviation) は [分散](/docs/glossary#variance)の正の平方根です。

- Excel での計算法

<DataGridMdx
  data={{
    cells: [
      [
        { value: "データ", readOnly: true, className: "orange-cell" },
        { value: "説明", readOnly: true, className: "orange-cell" },
      ],
      [
        { value: "8", readOnly: true },
        { value: "分布のパラメータ N の値", readOnly: true },
      ],
      [
        { value: "数式", readOnly: true, className: "orange-cell" },
        { value: "説明（計算結果）", readOnly: true, className: "orange-cell" },
      ],
      [
        { value: "=NTCHISTDEV(A2)", readOnly: true },
        { value: "上のデータに対する分布の標準偏差", readOnly: true },
      ],
    ],
  }}
/>

- 関連 NtRand 関数 : [NTCHISTDEV](../03-function-reference/02-distribution-functions/016-ntchistdev.mdx)

### 歪度 -- 分布はどちらに偏っているか([定義](/docs/glossary#skewness))

- 分布の[歪度](/docs/glossary#skewness)は次式で与えられます。

  $$
  \frac{\mu(3)-3\mu(2)\mu(1)+2\mu^3(1)}{\sigma^3}
  $$

  $$
  \mu(r)=\frac{2^{\frac{r}{2}}\Gamma\left(\frac{N+r}{2}\right)}{\Gamma\left(\frac{N}{2}\right)}
  $$

  ここで $\sigma$ は [標準偏差](/docs/glossary#standard-deviation) で $\Gamma(\cdot)$ は [ガンマ関数](/docs/glossary#gamma-function)です。

- Excel での計算法

<DataGridMdx
  data={{
    cells: [
      [
        { value: "データ", readOnly: true, className: "orange-cell" },
        { value: "説明", readOnly: true, className: "orange-cell" },
      ],
      [
        { value: "8", readOnly: true },
        { value: "分布のパラメータ N の値", readOnly: true },
      ],
      [
        { value: "数式", readOnly: true, className: "orange-cell" },
        { value: "説明（計算結果）", readOnly: true, className: "orange-cell" },
      ],
      [
        { value: "=NTCHISKEW(A2)", readOnly: true },
        { value: "上のデータに対する分布の歪度", readOnly: true },
      ],
    ],
  }}
/>

- 関連 NtRand 関数 : [NTCHISKEW](../03-function-reference/02-distribution-functions/015-ntchiskew.mdx)

### 尖度 -- 尖っているか丸まっているか ([定義](/docs/glossary#kurtosis))

- 分布の[尖度](/docs/glossary#kurtosis) は次式で与えられます。

  $$
  \frac{\mu(4)-4\mu(3)\mu(1)+6\mu(2)\mu^2(1)-3\mu^4(1)}{\sigma^4}-3
  $$

  $$
  \mu(r)=\frac{2^{\frac{r}{2}}\Gamma\left(\frac{N+r}{2}\right)}{\Gamma\left(\frac{N}{2}\right)}
  $$

  ここで $\sigma$ は [標準偏差](/docs/glossary#standard-deviation) で $\Gamma(\cdot)$ は [ガンマ関数](/docs/glossary#gamma-function)です。

- Excel での計算法

<DataGridMdx
  data={{
    cells: [
      [
        { value: "データ", readOnly: true, className: "orange-cell" },
        { value: "説明", readOnly: true, className: "orange-cell" },
      ],
      [
        { value: "8", readOnly: true },
        { value: "分布のパラメータ N の値", readOnly: true },
      ],
      [
        { value: "数式", readOnly: true, className: "orange-cell" },
        { value: "説明（計算結果）", readOnly: true, className: "orange-cell" },
      ],
      [
        { value: "=NTCHIKURT(A2)", readOnly: true },
        { value: "上のデータに対する分布の尖度", readOnly: true },
      ],
    ],
  }}
/>

- 関連 NtRand 関数 : [NTCHIKURT](../03-function-reference/02-distribution-functions/012-ntchikurt.mdx)

## 乱数

- Excel での乱数生成法

<DataGridMdx
  data={{
    cells: [
      [
        { value: "データ", readOnly: true, className: "orange-cell" },
        { value: "説明", readOnly: true, className: "orange-cell" },
      ],
      [
        { value: "8", readOnly: true },
        { value: "分布のパラメータ N の値", readOnly: true },
      ],
      [
        { value: "数式", readOnly: true, className: "orange-cell" },
        { value: "説明（計算結果）", readOnly: true, className: "orange-cell" },
      ],
      [
        { value: "=NTRANDCHI(100,A2,0)", readOnly: true },
        {
          value: "100個のカイ乱数を Mersenne Twister アルゴリズムで生成します",
          readOnly: true,
        },
      ],
    ],
  }}
/>

メモ： この使用例の数式は、配列数式として入力する必要があります。使用例を新規ワークシートにコピーした後、A4:A103 のセル範囲 (配列数式が入力されているセルが左上になる) を選択します。F2 キーを押し、Ctrl キーと Shift キーを押しながら Enter キーを押します。この数式が配列数式として入力されていない場合、単一の値 2 のみが計算結果として返されます。

## 関連 NtRand 関数

- 既に分布のパラメータをお持ちの場合
  - Mersenne Twiseter 法による乱数生成 : [NTRANDCHI](../03-function-reference/01-random-numbers/01-single-series/03-ntrandchi.mdx)
  - 確率計算 : [NTCHIDIST](../03-function-reference/02-distribution-functions/010-ntchidist.mdx)
  - 平均計算 : [NTCHIMEAN](../03-function-reference/02-distribution-functions/013-ntchimean.mdx)
  - 標準偏差計算 : [NTCHISTDEV](../03-function-reference/02-distribution-functions/015-ntchiskew.mdx)
  - 歪度計算 : [NTCHISKEW](../03-function-reference/02-distribution-functions/015-ntchiskew.mdx)
  - 尖度計算 : [NTCHIKURT](../03-function-reference/02-distribution-functions/012-ntchikurt.mdx)
  - 上記の各モーメントを一度に計算 : [NTCHIMOM](../03-function-reference/02-distribution-functions/014-ntchimom.mdx)

## 参照

- [Wolfram Mathworld -- Chi Distribution](http://mathworld.wolfram.com/ChiDistribution.html)
- [Wikipedia -- Chi distribution](http://en.wikipedia.org/wiki/Chi_distribution)
- [Statistics Online Computational Resource](http://www.socr.ucla.edu/htmls/SOCR_Distributions.html)
