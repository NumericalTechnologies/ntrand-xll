---
title: ジョンソン SB 分布(Johnson SB distribution)
---

import DataGridMdx from "@site/src/components/DataGridMdx";

# ジョンソン SB 分布(Johnson SB distribution)

## 分布の形状

### 基本情報

- 4つのパラメータ $\gamma, \delta,\lambda,\xi$ が必要です.

  $$
  \delta>0,\lambda>0
  $$

- 有限区間 $\xi\leq x \leq \xi+\lambda$ で定義された連続分布です。
- [平均](/docs/glossary#central-moment)対して対称にも非対称にもなり得ます。

### 確率

- [累積分布関数](/docs/glossary#cumulative-distribution-function)

  $$
  F(x)=\Phi\left(\gamma+\delta\ln\frac{z}{1-z}\right)
  $$

  ここで

  $$
  z=\frac{x-\xi}{\lambda}
  $$

  で、 $\Phi(\cdot)$ は 標準正規分布の[累積分布関数](/docs/glossary#cumulative-distribution-function)です。

- [確率密度関数](/docs/glossary#probability-density-function)

  $$
  f(x)=\frac{\delta}{\lambda\sqrt{2\pi}z(1-z)}\exp\left[-\frac{1}{2}\left(\gamma+\delta\ln\frac{z}{1-z}\right)^2\right]
  $$

- Excel での[累積分布関数 (c.d.f.)](/docs/glossary#cumulative-distribution-function) と [確率密度関数 (p.d.f.)](/docs/glossary#probability-density-function)の求め方

<DataGridMdx
  data={{
    cells: [
      [
        { value: "データ", readOnly: true, className: "orange-cell" },
        { value: "説明", readOnly: true, className: "orange-cell" },
      ],
      [
        { value: 0.5, readOnly: true },
        { value: "対象となる値", readOnly: true },
      ],
      [
        { value: 8, readOnly: true },
        { value: "分布のパラメータ Gamma の値", readOnly: true },
      ],
      [
        { value: 2, readOnly: true },
        { value: "分布のパラメータ Delta の値", readOnly: true },
      ],
      [
        { value: 2, readOnly: true },
        { value: "分布のパラメータ Lambda の値", readOnly: true },
      ],
      [
        { value: 2, readOnly: true },
        { value: "分布のパラメータ Xi の値", readOnly: true },
      ],
      [
        { value: "=(A2-A5)/A4", readOnly: true },
        { value: "Standardized variable z", readOnly: true },
      ],
      [
        { value: "数式", readOnly: true, className: "orange-cell" },
        { value: "説明（計算結果）", readOnly: true, className: "orange-cell" },
      ],
      [
        { value: "=NORMSDIST(A3+A4*LN(A7/(1-A7)))", readOnly: true },
        { value: "上のデータに対する累積分布関数の値", readOnly: true },
      ],
      [
        {
          value:
            "=A4*EXP(-0.5*(A3+A4*LN(A7/(1-A7)))^2)/(SQRT(2*PI())*A5*A7*(1-A7))",
          readOnly: true,
        },
        {
          value: "上のデータに対する確率密度関数の値",
          readOnly: true,
        },
      ],
    ],
  }}
/>

### 分位点

- [累積分布関数](/docs/glossary#cumulative-distribution-function)の逆関数

  $$
  F^{-1}(P)=\frac{\lambda\exp\left(\frac{\Phi^{-1}(P)-\gamma}{\delta}\right)}{1+\exp\left(\frac{\Phi^{-1}(P)-\gamma}{\delta}\right)}+\xi
  $$

  ここで $\Phi(\cdot)$ は標準正規分布の[累積分布関数](/docs/glossary#cumulative-distribution-function)です。

- Excel での[分位点](/docs/glossary#quantile)の求め方

<DataGridMdx
  data={{
    cells: [
      [
        { value: "データ", readOnly: true, className: "orange-cell" },
        { value: "説明", readOnly: true, className: "orange-cell" },
      ],
      [
        { value: 0.5, readOnly: true },
        { value: "この分布の確率", readOnly: true },
      ],
      [
        { value: 1.7, readOnly: true },
        { value: "分布のパラメータ Gamma の値", readOnly: true },
      ],
      [
        { value: 0.9, readOnly: true },
        { value: "分布のパラメータ Delta の値", readOnly: true },
      ],
      [
        { value: 0.9, readOnly: true },
        { value: "分布のパラメータ Lambda の値", readOnly: true },
      ],
      [
        { value: 0.9, readOnly: true },
        { value: "分布のパラメータ Xi の値", readOnly: true },
      ],
      [
        { value: "数式", readOnly: true, className: "orange-cell" },
        { value: "説明（計算結果）", readOnly: true, className: "orange-cell" },
      ],
      [
        {
          value:
            "=A5*EXP((NORMSINV(A2)-A3)/A4)/(1+EXP((NORMSINV(A2)-A3)/A4))+A6",
          readOnly: true,
        },
        { value: "上のデータに対する累積分布関数の逆関数の値", readOnly: true },
      ],
    ],
  }}
/>

## 乱数

- 乱数 x は一様乱数 U に対して次式で生成されます（逆関数法） :

  $$
  x=\frac{\lambda\exp\left(\frac{\Phi^{-1}(U)-\gamma}{\delta}\right)}{1+\exp\left(\frac{\Phi^{-1}(U)-\gamma}{\delta}\right)}+\xi
  $$

- Excel での乱数生成法

<DataGridMdx
  data={{
    cells: [
      [
        { value: "データ", readOnly: true, className: "orange-cell" },
        { value: "説明", readOnly: true, className: "orange-cell" },
      ],
      [
        { value: 0.5, readOnly: true },
        { value: "分布のパラメータ Gamma の値", readOnly: true },
      ],
      [
        { value: 0.5, readOnly: true },
        { value: "分布のパラメータ Delta の値", readOnly: true },
      ],
      [
        { value: 0.5, readOnly: true },
        { value: "分布のパラメータ Lambda の値", readOnly: true },
      ],
      [
        { value: 0.5, readOnly: true },
        { value: "分布のパラメータ Xi の値", readOnly: true },
      ],
      [
        { value: "数式", readOnly: true, className: "orange-cell" },
        { value: "説明（計算結果）", readOnly: true, className: "orange-cell" },
      ],
      [
        {
          value:
            "=A4*EXP((NORMSINV(NTRAND(100))-A2)/A3)/(1+EXP((NORMSINV(NTRAND(100))-A2)/A3))+A5",
          readOnly: true,
        },
        {
          value:
            "100個のジョンソン SB 乱数を Mersenne Twister アルゴリズムで生成します。",
          readOnly: true,
        },
      ],
    ],
  }}
/>

メモ： この使用例の数式は、配列数式として入力する必要があります。使用例を新規ワークシートにコピーした後、A7:A106 のセル範囲 (配列数式が入力されているセルが左上になる) を選択します。F2 キーを押し、Ctrl キーと Shift キーを押しながら Enter キーを押します。この数式が配列数式として入力されていない場合、単一の値 2 のみが計算結果として返されます。

## 参照

- [Statistics Online Computational Resource](http://www.socr.ucla.edu/htmls/SOCR_Distributions.html)
- [Epidemiology](http://en.wikipedia.org/wiki/Epidemiology)

  ["Fitting human exposure data with the Johnson SB distribution" by MICHAEL R. FLYNN](http://www.bvsde.paho.org/bvsacd/cd47/data.pdf)

- [Forestry](http://en.wikipedia.org/wiki/Forestry)

  ["Plotting Johnson's SB Distribution using a new parameterization" by Keith Rennolls1 et al](http://cms1.gre.ac.uk/conferences/iufro/FMA/SB_Plot_Minimum1.pdf)

  "A new parameterization of Johnson's SB distribution with application to fitting forest tree diameter data" by Keith Rennolls and Mingliang Wang
