---
title: NTRANDTRIANGULAR
---

import DataGridMdx from "@site/src/components/DataGridMdx";

# NTRANDTRIANGULAR

[三角分布](../../../05-gallery-of-distributions/triangular-distribution.mdx)に従う疑似乱数を返します。乱数は超長周期 ($2^{19937}-1$)、 かつ高次元均等性（623次元）を備えた[Mersenne Twister アルゴリズム](/docs/glossary#mersenne-twister-algorithm) を基に生成されます。

## 書式

```excel
NTRANDTRIANGULAR(
    Size,
    Min,
    Max,
    Mode,
    Algorithm,
    Random seed1,
    Random seed2
)
```

### 引数

- **_Size_**乱数の個数を指定します（正の整数）。
- **_Min_** 分布の下限値 $a$ を指定します。
- **_Max_** 分布の上限値 $b$ を指定します。
- **_Mode_** 分布の[最頻値](/docs/glossary#mode) $c$ を指定します。
- **_Algorithm_** 一様乱数を生成するアルゴリズムを下記の3つから選択します。この引数は省略することができます。
  - 0: Mersenne Twister(2002)
  - 1: Mersenne Twister(1998)
  - 2: Numerical Recipes ran2()
- **_Random seed1_** 第1乱数シードを指定します。この引数は省略することが出来ます。
- **_Random seed2_** 第2乱数シードを指定します。この引数は省略することが出来ます。

## 解説

- 分布のパラメータは $a < c < b$ を満たす必要があります。
- 乱数$x$ は、$[0,1]$ の一様乱数$U$から、

  $$
  x=\begin{cases}\sqrt{U(c-a)(b-a)}+a&\left(U<\frac{c-a}{b-a}\right)\\-\sqrt{(1-U)(b-c)(b-a)}+b&\left(U\geq\frac{c-a}{b-a}\right)\end{cases}
  $$

  として計算されます（逆関数法）。

## 使用例

![](./../../../assets/functions/histogram/histogramTriangular.jpg)

- 使用例を新規のワークシートにコピーすると、計算結果を確認できます。

<details>
<summary>その方法は？</summary>

1.  新しいブックまたはワークシートを作成します。
2.  ヘルプ トピックにある使用例を選択します（行番号および列番号を除く）。

    ![Selecting an example from Help](./../../../assets/functions/HowToCopy.png)

    ヘルプから使用例を選択する

3.  Ctrl キーを押しながら C キーを押します。
4.  ワークシートのセル A1 を選択し、Ctrl キーを押しながら V キーを押します。
5.  計算結果と結果を返す数式の表示を切り替えるには、Ctrl キーを押しながら ` (アクサン グラーブ) キーを押すか、または [ツール] メニューの [ワークシート分析] をポイントし、[ワークシート分析モード] をクリックします。

</details>

<DataGridMdx
  data={{
    cells: [
      [
        { value: "データ", readOnly: true, className: "orange-cell" },
        { value: "説明", readOnly: true, className: "orange-cell" },
      ],
      [
        { value: 1, readOnly: true },
        { value: "Lower limit of support", readOnly: true },
      ],
      [
        { value: 3, readOnly: true },
        { value: "Upper limit of support", readOnly: true },
      ],
      [
        { value: 1.4, readOnly: true },
        { value: "Mode of the distribution", readOnly: true },
      ],
      [
        { value: "数式", readOnly: true, className: "orange-cell" },
        { value: "説明（計算結果）", readOnly: true, className: "orange-cell" },
      ],
      [
        { value: "=NTRANDTRIANGULAR(100,A2,A3,A4,0)", readOnly: true },
        {
          value:
            "100個の三角乱数を Mersenne Twister アルゴリズムで生成します。",
          readOnly: true,
        },
      ],
    ],
  }}
/>

メモ： この使用例の数式は、配列数式として入力する必要があります。使用例を新規ワークシートにコピーした後、A6:A105 のセル範囲 (配列数式が入力されているセルが左上になる) を選択します。F2 キーを押し、Ctrl キーと Shift キーを押しながら Enter キーを押します。この数式が配列数式として入力されていない場合、単一の値 2 のみが計算結果として返されます。

- [サンプル Excel シートをダウンロード](./../../../assets/NtRand1.zip)

## 参照

- [NTTRIANGULARDIST](../../02-distribution-functions/087-nttriangulardist.mdx)
- [NTTRIANGULARINV](../../02-distribution-functions/088-nttriangularinv.mdx)
- [NTTRIANGULARKURT](../../02-distribution-functions/089-nttriangularkurt.mdx)
- [NTTRIANGULARMEAN](../../02-distribution-functions/090-nttriangularmean.mdx)
- [NTTRIANGULARMOM](../../02-distribution-functions/091-nttriangularmom.mdx)
- [NTTRIANGULARPARAM](../../02-distribution-functions/092-nttriangularparam.mdx)
- [NTTRIANGULARSKEW](../../02-distribution-functions/093-nttriangularskew.mdx)
- [NTTRIANGULARSTDEV](../../02-distribution-functions/094-nttriangularstdev.mdx)
- [三角分布](../../../05-gallery-of-distributions/triangular-distribution.mdx)
- [乱数アルゴリズムの選択](/docs/glossary#choice-of-the-random-number-generator-algorithm)
- [どうして複数のセルに数式をコピーすると全部同じ結果になるの？](/docs/faq#why-i-always-see-the-same-result-even-if-i-input-formula-into-multiple-cell)
