---
title: NTRANDMULTINORM
---

import DataGridMdx from "@site/src/components/DataGridMdx";

# NTRANDMULTINORM

Returns multivariate normal pseudo random number(s) based on [Mersenne Twister Algorithm](/docs/glossary#mersenne-twister-algorithm) which has long period ($2^{19937}-1$), high order of equidistribution (623 dimensions).

## Syntax

```excel
NTRANDMULTINORM(
  Size,
  Cov,
  Mean,
  Algorithm,
  Random seed1,
  Random seed2,
  Use invert func,
  Use antithetic,
  Use resampling
)
```

### Parameters

- **_Size_** is # of random numbers (Positive integer).
- **_Cov_** is a covariance matrix.
- **_Mean_** is a vector of the arithmetic means of each variable.
- **_Algorithm_** is a integer value that determines a method to generate uniform random number.
  - 0: Mersenne Twister(2002)
  - 1: Mersenne Twister(1998)
  - 2: Numerical Recipes\
    ran2()
- **_Random seed1_** is 1st. random seed.
- **_Random seed2_** is 2nd. random seed.
- **_Use invert func_** is a logical value that determines a method to generate normal random number. If Use invert func is TRUE, inverse function method is used; if FALSE, box-Muller method is used.
- **_Use antithetic_** is a logical value that determines antithetic variant method is used or not. If Use antithetic is TRUE, antithetic variant method is used; if FALSE, antithetic variant method is not used.
- **_Use resampling_** is a logical value that determines quadratic resampling method is used or not. If Use resampling is TRUE, quadratic resampling method is used; if FALSE, quadratic resampling method is not used.

## Example

![](./../../../assets/functions/histogram/scatterMultiNorm.jpg)

- The example may be easier to understand if you copy it to a blank worksheet

<details>
  <summary>How to copy an example</summary>

1.  Create a blank workbook or worksheet.
2.  Select the example in the Help topic.

    **Note**  Do not select the row or column headers.

    ![Selecting an example from Help](./../../../assets/functions/HowToCopy.png)

    Selecting an example from Help

3.  Press CTRL+C.
4.  In the worksheet, select cell A1, and press CTRL+V.
5.  To switch between viewing the results and viewing the formulas that return the results, press CTRL+` (grave accent), or on the **Tools** menu, point to **Formula Auditing**, and then click **Formula Auditing Mode**.

</details>

<DataGridMdx
  data={{
    cells: [
      [
        { value: "Data", readOnly: true, className: "orange-cell" },
        { value: "Data", readOnly: true, className: "orange-cell" },
        { value: "Data", readOnly: true, className: "orange-cell" },
        { value: "Description", readOnly: true, className: "orange-cell" },
      ],
      [
        { value: "1.44", readOnly: true },
        { value: "0.48", readOnly: true },
        { value: "-0.36", readOnly: true },
        { value: "cov. matrix", readOnly: true },
      ],
      [
        { value: "0.48", readOnly: true },
        { value: "0.64", readOnly: true },
        { value: "0", readOnly: true },
        { value: "cov. matrix", readOnly: true },
      ],
      [
        { value: "-0.36", readOnly: true },
        { value: "0", readOnly: true },
        { value: "0.25", readOnly: true },
        { value: "cov. matrix", readOnly: true },
      ],
      [
        { value: "Data", readOnly: true, className: "orange-cell" },
        { value: "Data", readOnly: true, className: "orange-cell" },
        { value: "Data", readOnly: true, className: "orange-cell" },
        { value: "Description", readOnly: true, className: "orange-cell" },
      ],
      [
        { value: "1", readOnly: true },
        { value: "2", readOnly: true },
        { value: "3", readOnly: true },
        { value: "mean vector", readOnly: true },
      ],
      [
        { value: "Formula", readOnly: true, className: "orange-cell" },
        { value: "", readOnly: true, className: "orange-cell" },
        { value: "", readOnly: true, className: "orange-cell" },
        {
          value: "Description (Result)",
          readOnly: true,
          className: "orange-cell",
        },
      ],
      [
        { value: "=NTRANDMULTINORM(100,A2:C4,A6:C6)", readOnly: true },
        { value: "", readOnly: true },
        { value: "", readOnly: true },
        {
          value: "100 normal deviates (x 3 variables) for the terms above",
          readOnly: true,
        },
      ],
    ],
  }}
/>

Note The formula in the example must be entered as an array formula. After copying the example to a blank worksheet, select the range A8:C107 starting with the formula cell. Press F2, and then press CTRL+SHIFT+ENTER.

- [Download sample excel sheet](./../../../assets/NtRand1.zip)

## See also

- [Normal distribution (Multi variables)](../../../05-gallery-of-distributions/normal-distribution-multi.mdx)
- [Choice of the random number generator algorithm](/docs/glossary#choice-of-the-random-number-generator-algorithm)
- [Why I always see the same result even if I input formula into multiple cell?](/docs/faq#why-i-always-see-the-same-result-even-if-i-input-formula-into-multiple-cell)
